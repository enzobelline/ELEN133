
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>lab2</title><meta name="generator" content="MATLAB 9.8"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-04-13"><meta name="DC.source" content="lab2.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">Section 1 and 2</a></li><li><a href="#3">Section 3</a></li><li><a href="#4">Section 4</a></li><li><a href="#5">Section 5</a></li><li><a href="#6">Comparison of Four Second Order Systems</a></li><li><a href="#7">Cascade connection of two first order systems</a></li></ul></div><pre class="codeinput">clc
close <span class="string">all</span>;
clear <span class="string">all</span>;
</pre><h2 id="2">Section 1 and 2</h2><pre class="codeinput">freq1 = 0.01;
freq2 = 0.1;
freq3 = 0.4;
n_in = 256;

nv = 0:(n_in - 1);

x1 = [1 , zeros(1,255)];

figure(1)
subplot(2,2,1)
x2 = square(nv*2*pi/256);
stem(nv(1:n_in),x2(1:n_in))

subplot(2,2,2)
x3 = cos(freq1*2*pi*nv);
stem(nv(1:n_in),x3(1:n_in))

subplot(2,2,3)
x4 = cos(freq2*2*pi*nv);
stem(nv(1:n_in),x4(1:n_in))

subplot(2,2,4)
x5 = cos(freq3*2*pi*nv);
stem(nv(1:n_in),x5(1:n_in))
</pre><img vspace="5" hspace="5" src="lab2_01.png" alt=""> <h2 id="3">Section 3</h2><pre class="codeinput">a = [1.0,-0.9];
b = 1;

figure(2)
subplot(2,1,1)
y1 = filter(b,a,x1);
plot(nv(1:n_in),y1(1:n_in))
hold <span class="string">on</span>

y2 = filter(b,a,x2);
plot(nv(1:n_in),y2(1:n_in))

hold <span class="string">off</span>

subplot(2,1,2)
y3 = filter(b,a,x3);
plot(nv(1:n_in),y3(1:n_in))
hold <span class="string">on</span>

y4 = filter(b,a,x4);
plot(nv(1:n_in),y4(1:n_in))

y5 = filter(b,a,x5);
plot(nv(1:n_in),y5(1:n_in))

hold <span class="string">off</span>
</pre><img vspace="5" hspace="5" src="lab2_02.png" alt=""> <h2 id="4">Section 4</h2><pre class="codeinput">a = [1.0,-0.9];
b = 1;

figure(3)
title(<span class="string">'System 2'</span>)
subplot(2,1,1)
y1 = filter(b,a,x1);
plot(nv(1:n_in),y1(1:n_in),<span class="string">'r'</span>)
hold <span class="string">on</span>

y2 = filter(b,a,x2);
plot(nv(1:n_in),y2(1:n_in),<span class="string">'g'</span>)

hold <span class="string">off</span>

subplot(2,1,2)
y3 = filter(b,a,x3);
plot(nv(1:n_in),y3(1:n_in),<span class="string">'r'</span>)
hold <span class="string">on</span>

y4 = filter(b,a,x4);
plot(nv(1:n_in),y4(1:n_in),<span class="string">'g'</span>)

y5 = filter(b,a,x5);
plot(nv(1:n_in),y5(1:n_in),<span class="string">'b'</span>)

hold <span class="string">off</span>
<span class="comment">% y3 = 8.59, y4 = 1.6, y5 = 0.5291</span>
<span class="comment">% y3 has the highest amplitude and y5 has the lowest amplitude</span>

<span class="comment">% The impulse response is the output when presented witha brief input</span>
<span class="comment">% signal.</span>
<span class="comment">% For the step response you can see that the filter function created a rise</span>
<span class="comment">% time for the values to reach its peak and a fall time for it to reach its</span>
<span class="comment">% minimum. The impulse function shows the small falltime untilit reached</span>
<span class="comment">% zero.</span>

<span class="comment">% What is the steady state response after a step input?</span>
<span class="comment">% It oscillates from -10 to 10</span>
<span class="comment">% y(n) = x(n) +1y(n-1)- 0.9y(n-2)</span>
</pre><img vspace="5" hspace="5" src="lab2_03.png" alt=""> <img vspace="5" hspace="5" src="lab2_04.png" alt=""> <h2 id="5">Section 5</h2><p>Comparison of two first order systems.</p><pre class="codeinput">a = [1.0,0.9];
b = 1;

figure(4)
subplot(2,1,1)
y1 = filter(b,a,x1);
plot(nv(1:n_in),y1(1:n_in))

hold <span class="string">on</span>
y2 = filter(b,a,x2);
plot(nv(1:n_in),y2(1:n_in))
hold <span class="string">off</span>

subplot(2,1,2)
y3 = filter(b,a,x3);
plot(nv(1:n_in),y3(1:n_in),<span class="string">'r'</span>)
hold <span class="string">on</span>

y4 = filter(b,a,x4);
plot(nv(1:n_in),y4(1:n_in),<span class="string">'g'</span>)

y5 = filter(b,a,x5);
plot(nv(1:n_in),y5(1:n_in),<span class="string">'b'</span>)
hold <span class="string">off</span>

<span class="comment">% 4. y3 = 0.524, y4 = 0.529, y5 = 1.66</span>
<span class="comment">% y5 has the highest amplitude and y3 has the lowest amplitude</span>

<span class="comment">% For the impulse there is an initial oscillation that stabilizes at 0 after a short time</span>
<span class="comment">%for the step function there is an oscillation during the rise period to the</span>
<span class="comment">%high value until it stabilizes and then another delayed oscillation during the fall time</span>
<span class="comment">%to the low value until it stabilizes after a short period of time</span>

<span class="comment">% It oscillates from -1.75 to 1.75</span>
<span class="comment">% y(n) = x(n) +1y(n-1)+ 0.9y(n-2)</span>

<span class="comment">% 5. Compare System 1 and System 2.</span>
<span class="comment">% &#8226; What is the effect of changing the sign of a(2) on the impulse and step</span>
<span class="comment">% response for these two systems?</span>
<span class="comment">% The LPF will become a HPF as the second value will be the negative of the</span>
<span class="comment">% original</span>

<span class="comment">% &#8226; What do you think will happen if the absolute value of a(2) is decreased?</span>
<span class="comment">% Why?</span>
<span class="comment">%The steady state amplitude will be lower becasue the denominator is</span>
<span class="comment">%higher.</span>

<span class="comment">% &#8226; What do you think will happen if the absolute value of a(2) is increased?</span>
<span class="comment">% Why?</span>
<span class="comment">%The steady state amplitude will be higher becasue the denominator is</span>
<span class="comment">%smaller.</span>

<span class="comment">% &#8226; If System 1 is used as an &#8220;exponential average&#8221;, what value should b(1) have</span>
<span class="comment">% to insure that for a constant input value, the output will be that same value?</span>
<span class="comment">% We should have 0.1 or 1/10 because the times constant is 10 samples.</span>
</pre><img vspace="5" hspace="5" src="lab2_05.png" alt=""> <img vspace="5" hspace="5" src="lab2_06.png" alt=""> <h2 id="6">Comparison of Four Second Order Systems</h2><pre class="codeinput">alpha  = 0.95;
alpha2 = 0.99;
w = 2 * pi * 0.1;
<span class="comment">% System 3</span>
a3 = [1, -2*alpha*cos(w), alpha^2];
b3 = [1, -alpha*cos(w)];
figure(5)
subplot(2,1,1)
y1 = filter(b3,a3,x1);
plot(nv(1:n_in),y1(1:n_in))
hold <span class="string">on</span>

y2 = filter(b3,a3,x2);
plot(nv(1:n_in),y2(1:n_in))

hold <span class="string">off</span>

subplot(2,1,2)
y3 = filter(b3,a3,x3);
plot(nv(1:n_in),y3(1:n_in),<span class="string">"r"</span>)
hold <span class="string">on</span>

y4 = filter(b3,a3,x4);
plot(nv(1:n_in),y4(1:n_in),<span class="string">"g"</span>)

y5 = filter(b3,a3,x5);
plot(nv(1:n_in),y5(1:n_in),<span class="string">"b"</span>)

hold <span class="string">off</span>


<span class="comment">% System 4</span>
a4 = [1, -2*alpha*cos(2*w), alpha^2];
b4 = [1, -alpha*cos(2*w)];
figure(6)
subplot(2,1,1)
y1 = filter(b4,a4,x1);
plot(nv(1:n_in),y1(1:n_in))
hold <span class="string">on</span>

y2 = filter(b4,a4,x2);
plot(nv(1:n_in),y2(1:n_in))

hold <span class="string">off</span>
subplot(2,1,2)
y3 = filter(b4,a4,x3);
plot(nv(1:n_in),y3(1:n_in),<span class="string">"r"</span>)
hold <span class="string">on</span>

y4 = filter(b4,a4,x4);
plot(nv(1:n_in),y4(1:n_in),<span class="string">"g"</span>)

y5 = filter(b4,a4,x5);
plot(nv(1:n_in),y5(1:n_in),<span class="string">"b"</span>)

hold <span class="string">off</span>

<span class="comment">% System 5</span>

a5 = [1, -2*alpha2*cos(w), alpha2^2];
b5 = [1, -alpha2*cos(w)];
figure(7)
subplot(2,1,1)
y1 = filter(b5,a5,x1);
plot(nv(1:n_in),y1(1:n_in))
hold <span class="string">on</span>

y2 = filter(b5,a5,x2);
plot(nv(1:n_in),y2(1:n_in))

hold <span class="string">off</span>

subplot(2,1,2)
y3 = filter(b5,a5,x3);
plot(nv(1:n_in),y3(1:n_in),<span class="string">"r"</span>)
hold <span class="string">on</span>

y4 = filter(b5,a5,x4);
plot(nv(1:n_in),y4(1:n_in),<span class="string">"g"</span>)

y5 = filter(b5,a5,x5);
plot(nv(1:n_in),y5(1:n_in),<span class="string">"b"</span>)

hold <span class="string">off</span>

<span class="comment">% System 6</span>
a6 = [1, -2*alpha*cos(w), alpha^2];
b6 = [0, alpha*sin(w)] ;

figure(8)
subplot(2,1,1)
y1 = filter(b6,a6,x1);
plot(nv(1:n_in),y1(1:n_in))
hold <span class="string">on</span>

y2 = filter(b6,a6,x2);
plot(nv(1:n_in),y2(1:n_in))

hold <span class="string">off</span>

subplot(2,1,2)
y3 = filter(b6,a6,x3);
plot(nv(1:n_in),y3(1:n_in),<span class="string">"r"</span>)
hold <span class="string">on</span>

y4 = filter(b6,a6,x4);
plot(nv(1:n_in),y4(1:n_in),<span class="string">"g"</span>)

y5 = filter(b6,a6,x5);
plot(nv(1:n_in),y5(1:n_in),<span class="string">"b"</span>)

hold <span class="string">off</span>

<span class="comment">% 2. Compare System 3 and System 4.</span>
<span class="comment">% &#8226; Describe the impulse response of each system.</span>
<span class="comment">%The impulse response for both systems is initial oscillation whose magnitude approaches 0. System 4 has a greater frequency of oscillation than system 3.</span>

<span class="comment">% &#8226; How does using 2w instead of w affect the impulse and step responses?</span>
<span class="comment">% Doubling the freqeuncy increases the oscillation for both the impulse and step responses, but only affects the magnitude for the step response.</span>

<span class="comment">% &#8226; How does using 2w instead of w affect the response to the cosines at the</span>
<span class="comment">% three different input frequencies?</span>
<span class="comment">% The 0.01 Hz signal has a transient oscillation with a larger fundamental amplitude is lower in magnitude but lasts longer,</span>
<span class="comment">% The 0.1 Hz signal takes longer to reach steady state, amplitude is greater</span>
<span class="comment">% The 0.4 Hz signal has less transient oscillation but it lasts longer, amplitude is greater</span>

<span class="comment">% 3. Compare System 3 and System 5. How does increasing alpha affect:</span>
<span class="comment">% &#8226; the duration of the impulse responses?</span>
<span class="comment">% Increasing the alpha effect causes the system to take longer to reach steady state</span>
<span class="comment">% and as a result, the impulse response for system 5 is still oscillating by the final sample.</span>

<span class="comment">% &#8226; the relative response to the three different input frequencies?</span>
<span class="comment">% The 0.01 Hz signal has a transient oscillation with a larger fundamental amplitude is lower in magnitude but lasts longer,</span>
<span class="comment">% The 0.1 Hz signal takes longer to reach steady state, amplitude is greater</span>
<span class="comment">% The 0.4 Hz signal has less transient oscillation but it lasts longer, amplitude is greater</span>

<span class="comment">% 4. Compare System 3 and System 6:</span>
<span class="comment">% &#8226; Compare the impulse and frequency responses over the full time interval.</span>
<span class="comment">% Zoom in on the first 20 samples and compare again.</span>
<span class="comment">% The impulse response is very similar, but system 6 starts a sine</span>
<span class="comment">% behaviour while the system 3 starts a cosine behaviour. All with the same</span>
<span class="comment">% frequency.</span>

<span class="comment">% &#8226; Compare the steady state amplitudes of the responses to cosines at the</span>
<span class="comment">% three different input frequencies.</span>
<span class="comment">% The 0.1Hz has a similar amplitudes while the 0.01Hz is rejected by the</span>
<span class="comment">% System 3, while the system 6 rejects the 0.4Hz better</span>
</pre><img vspace="5" hspace="5" src="lab2_07.png" alt=""> <img vspace="5" hspace="5" src="lab2_08.png" alt=""> <img vspace="5" hspace="5" src="lab2_09.png" alt=""> <img vspace="5" hspace="5" src="lab2_10.png" alt=""> <h2 id="7">Cascade connection of two first order systems</h2><pre class="codeinput">a1 = [1.0,-0.9];
b1 = 1;

a7 = 1;
b7 = [1,-0.9];

<span class="comment">% impulse response</span>
figure(9)
subplot(2,1,1)
h1 = filter(b1,a1,x1);
stem(nv(1:50),h1(1:50))

subplot(2,1,2)
h7 = filter(b7,a7,x1);
stem(nv(1:50),h7(1:50))

<span class="comment">% cascade connections</span>
figure(10)
subplot(2,1,1)
z7 = filter(b7,a7,h1);
stem(nv(1:10),z7(1:10))

subplot(2,1,2)
z1 = filter(b1,a1,h7);
stem(nv(1:10),z1(1:10))

<span class="comment">% 3. Draw block diagrams for the two cascaded systems and label h1, z7, h7, and z1.</span>
<span class="comment">%    Check external figure.</span>
<span class="comment">%</span>
<span class="comment">% 4. Analytically compute the first 5 values of y1, z1, y7, and z7.</span>
<span class="comment">% y1 = 1, 0.9, 0.81 , 0.7290, 0.6561</span>
<span class="comment">% z1 = 1, 0  , 0    , 0     , 0;</span>
<span class="comment">% y7 = 1,-0.9, 0    , 0     , 0;</span>
<span class="comment">% z7 = 1,   0, 0    , 0     ,  0;</span>
<span class="comment">%</span>
<span class="comment">% 5. y7 and z7 has an extra impulse at n=1 and would decrease to zero slower.</span>
</pre><img vspace="5" hspace="5" src="lab2_11.png" alt=""> <img vspace="5" hspace="5" src="lab2_12.png" alt=""> <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020a</a><br></p></div><!--
##### SOURCE BEGIN #####
clc 
close all;
clear all;

%% Section 1 and 2
freq1 = 0.01;
freq2 = 0.1;
freq3 = 0.4;
n_in = 256;

nv = 0:(n_in - 1);

x1 = [1 , zeros(1,255)];

figure(1)
subplot(2,2,1)
x2 = square(nv*2*pi/256);
stem(nv(1:n_in),x2(1:n_in))

subplot(2,2,2)
x3 = cos(freq1*2*pi*nv);
stem(nv(1:n_in),x3(1:n_in))

subplot(2,2,3)
x4 = cos(freq2*2*pi*nv);
stem(nv(1:n_in),x4(1:n_in))

subplot(2,2,4)
x5 = cos(freq3*2*pi*nv);
stem(nv(1:n_in),x5(1:n_in))

%% Section 3
a = [1.0,-0.9];
b = 1;

figure(2)
subplot(2,1,1)
y1 = filter(b,a,x1);
plot(nv(1:n_in),y1(1:n_in))
hold on

y2 = filter(b,a,x2);
plot(nv(1:n_in),y2(1:n_in))

hold off

subplot(2,1,2)
y3 = filter(b,a,x3);
plot(nv(1:n_in),y3(1:n_in))
hold on

y4 = filter(b,a,x4);
plot(nv(1:n_in),y4(1:n_in))

y5 = filter(b,a,x5);
plot(nv(1:n_in),y5(1:n_in))

hold off
%% Section 4
a = [1.0,-0.9];
b = 1;

figure(3)
title('System 2')
subplot(2,1,1)
y1 = filter(b,a,x1);
plot(nv(1:n_in),y1(1:n_in),'r')
hold on

y2 = filter(b,a,x2);
plot(nv(1:n_in),y2(1:n_in),'g')

hold off

subplot(2,1,2)
y3 = filter(b,a,x3);
plot(nv(1:n_in),y3(1:n_in),'r')
hold on

y4 = filter(b,a,x4);
plot(nv(1:n_in),y4(1:n_in),'g')

y5 = filter(b,a,x5);
plot(nv(1:n_in),y5(1:n_in),'b')

hold off
% y3 = 8.59, y4 = 1.6, y5 = 0.5291
% y3 has the highest amplitude and y5 has the lowest amplitude

% The impulse response is the output when presented witha brief input
% signal.
% For the step response you can see that the filter function created a rise
% time for the values to reach its peak and a fall time for it to reach its
% minimum. The impulse function shows the small falltime untilit reached
% zero. 

% What is the steady state response after a step input? 
% It oscillates from -10 to 10
% y(n) = x(n) +1y(n-1)- 0.9y(n-2)

%% Section 5
% Comparison of two first order systems.
a = [1.0,0.9];
b = 1;

figure(4)
subplot(2,1,1)
y1 = filter(b,a,x1);
plot(nv(1:n_in),y1(1:n_in))

hold on
y2 = filter(b,a,x2);
plot(nv(1:n_in),y2(1:n_in))
hold off

subplot(2,1,2)
y3 = filter(b,a,x3);
plot(nv(1:n_in),y3(1:n_in),'r')
hold on

y4 = filter(b,a,x4);
plot(nv(1:n_in),y4(1:n_in),'g')

y5 = filter(b,a,x5);
plot(nv(1:n_in),y5(1:n_in),'b')
hold off

% 4. y3 = 0.524, y4 = 0.529, y5 = 1.66
% y5 has the highest amplitude and y3 has the lowest amplitude

% For the impulse there is an initial oscillation that stabilizes at 0 after a short time
%for the step function there is an oscillation during the rise period to the 
%high value until it stabilizes and then another delayed oscillation during the fall time 
%to the low value until it stabilizes after a short period of time

% It oscillates from -1.75 to 1.75
% y(n) = x(n) +1y(n-1)+ 0.9y(n-2) 

% 5. Compare System 1 and System 2.
% • What is the effect of changing the sign of a(2) on the impulse and step
% response for these two systems?
% The LPF will become a HPF as the second value will be the negative of the
% original

% • What do you think will happen if the absolute value of a(2) is decreased?
% Why?
%The steady state amplitude will be lower becasue the denominator is
%higher.

% • What do you think will happen if the absolute value of a(2) is increased?
% Why?
%The steady state amplitude will be higher becasue the denominator is
%smaller.

% • If System 1 is used as an “exponential average”, what value should b(1) have
% to insure that for a constant input value, the output will be that same value?
% We should have 0.1 or 1/10 because the times constant is 10 samples.
%% Comparison of Four Second Order Systems
alpha  = 0.95;
alpha2 = 0.99;
w = 2 * pi * 0.1;
% System 3
a3 = [1, -2*alpha*cos(w), alpha^2];
b3 = [1, -alpha*cos(w)];
figure(5)
subplot(2,1,1)
y1 = filter(b3,a3,x1);
plot(nv(1:n_in),y1(1:n_in))
hold on

y2 = filter(b3,a3,x2);
plot(nv(1:n_in),y2(1:n_in))

hold off

subplot(2,1,2)
y3 = filter(b3,a3,x3);
plot(nv(1:n_in),y3(1:n_in),"r")
hold on

y4 = filter(b3,a3,x4);
plot(nv(1:n_in),y4(1:n_in),"g")

y5 = filter(b3,a3,x5);
plot(nv(1:n_in),y5(1:n_in),"b")

hold off


% System 4
a4 = [1, -2*alpha*cos(2*w), alpha^2];
b4 = [1, -alpha*cos(2*w)];
figure(6)
subplot(2,1,1)
y1 = filter(b4,a4,x1);
plot(nv(1:n_in),y1(1:n_in))
hold on

y2 = filter(b4,a4,x2);
plot(nv(1:n_in),y2(1:n_in))

hold off
subplot(2,1,2)
y3 = filter(b4,a4,x3);
plot(nv(1:n_in),y3(1:n_in),"r")
hold on

y4 = filter(b4,a4,x4);
plot(nv(1:n_in),y4(1:n_in),"g")

y5 = filter(b4,a4,x5);
plot(nv(1:n_in),y5(1:n_in),"b")

hold off

% System 5

a5 = [1, -2*alpha2*cos(w), alpha2^2];
b5 = [1, -alpha2*cos(w)];
figure(7)
subplot(2,1,1)
y1 = filter(b5,a5,x1);
plot(nv(1:n_in),y1(1:n_in))
hold on

y2 = filter(b5,a5,x2);
plot(nv(1:n_in),y2(1:n_in))

hold off

subplot(2,1,2)
y3 = filter(b5,a5,x3);
plot(nv(1:n_in),y3(1:n_in),"r")
hold on

y4 = filter(b5,a5,x4);
plot(nv(1:n_in),y4(1:n_in),"g")

y5 = filter(b5,a5,x5);
plot(nv(1:n_in),y5(1:n_in),"b")

hold off

% System 6
a6 = [1, -2*alpha*cos(w), alpha^2];
b6 = [0, alpha*sin(w)] ;

figure(8)
subplot(2,1,1)
y1 = filter(b6,a6,x1);
plot(nv(1:n_in),y1(1:n_in))
hold on

y2 = filter(b6,a6,x2);
plot(nv(1:n_in),y2(1:n_in))

hold off

subplot(2,1,2)
y3 = filter(b6,a6,x3);
plot(nv(1:n_in),y3(1:n_in),"r")
hold on

y4 = filter(b6,a6,x4);
plot(nv(1:n_in),y4(1:n_in),"g")

y5 = filter(b6,a6,x5);
plot(nv(1:n_in),y5(1:n_in),"b")

hold off

% 2. Compare System 3 and System 4.
% • Describe the impulse response of each system.
%The impulse response for both systems is initial oscillation whose magnitude approaches 0. System 4 has a greater frequency of oscillation than system 3.

% • How does using 2w instead of w affect the impulse and step responses?
% Doubling the freqeuncy increases the oscillation for both the impulse and step responses, but only affects the magnitude for the step response.

% • How does using 2w instead of w affect the response to the cosines at the
% three different input frequencies?
% The 0.01 Hz signal has a transient oscillation with a larger fundamental amplitude is lower in magnitude but lasts longer, 
% The 0.1 Hz signal takes longer to reach steady state, amplitude is greater
% The 0.4 Hz signal has less transient oscillation but it lasts longer, amplitude is greater

% 3. Compare System 3 and System 5. How does increasing alpha affect:
% • the duration of the impulse responses?
% Increasing the alpha effect causes the system to take longer to reach steady state 
% and as a result, the impulse response for system 5 is still oscillating by the final sample.

% • the relative response to the three different input frequencies?
% The 0.01 Hz signal has a transient oscillation with a larger fundamental amplitude is lower in magnitude but lasts longer, 
% The 0.1 Hz signal takes longer to reach steady state, amplitude is greater
% The 0.4 Hz signal has less transient oscillation but it lasts longer, amplitude is greater

% 4. Compare System 3 and System 6:
% • Compare the impulse and frequency responses over the full time interval.
% Zoom in on the first 20 samples and compare again.
% The impulse response is very similar, but system 6 starts a sine
% behaviour while the system 3 starts a cosine behaviour. All with the same
% frequency.

% • Compare the steady state amplitudes of the responses to cosines at the
% three different input frequencies.
% The 0.1Hz has a similar amplitudes while the 0.01Hz is rejected by the
% System 3, while the system 6 rejects the 0.4Hz better

%% Cascade connection of two first order systems
a1 = [1.0,-0.9];
b1 = 1;

a7 = 1;
b7 = [1,-0.9];

% impulse response
figure(9)
subplot(2,1,1)
h1 = filter(b1,a1,x1);
stem(nv(1:50),h1(1:50))

subplot(2,1,2)
h7 = filter(b7,a7,x1);
stem(nv(1:50),h7(1:50))

% cascade connections
figure(10)
subplot(2,1,1)
z7 = filter(b7,a7,h1);
stem(nv(1:10),z7(1:10))

subplot(2,1,2)
z1 = filter(b1,a1,h7);
stem(nv(1:10),z1(1:10))

% 3. Draw block diagrams for the two cascaded systems and label h1, z7, h7, and z1.
%    Check external figure.
% 
% 4. Analytically compute the first 5 values of y1, z1, y7, and z7.
% y1 = 1, 0.9, 0.81 , 0.7290, 0.6561
% z1 = 1, 0  , 0    , 0     , 0;
% y7 = 1,-0.9, 0    , 0     , 0;
% z7 = 1,   0, 0    , 0     ,  0;
% 
% 5. y7 and z7 has an extra impulse at n=1 and would decrease to zero slower.
##### SOURCE END #####
--></body></html>